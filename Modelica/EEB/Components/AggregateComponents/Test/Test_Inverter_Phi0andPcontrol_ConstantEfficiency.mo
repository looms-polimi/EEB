within EEB.Components.AggregateComponents.Test;
model Test_Inverter_Phi0andPcontrol_ConstantEfficiency
  Electrical.Inverter_Phi0_ConstantEfficiency INV1(eta = 0.9) annotation(Placement(transformation(extent = {{-40, 78}, {0, 118}})));
  Modelica.Electrical.Analog.Basic.Ground DCgnd annotation(Placement(transformation(extent = {{-100, -114}, {-80, -94}})));
  Modelica.Electrical.Analog.Basic.Resistor DCR1(R = 1) annotation(Placement(transformation(extent = {{-82, 100}, {-62, 120}})));
  Modelica.Electrical.Analog.Sources.ConstantVoltage VDC(V = 400) annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 270, origin = {-90, -74})));
  BaseComponents.Electrical.Phasors.Load_VPcosphi_nom ACload1 annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 270, origin = {30, 98})));
  BaseComponents.Electrical.Phasors.Ground ACgnd annotation(Placement(transformation(extent = {{0, -114}, {20, -94}})));
  Modelica.Electrical.Analog.Basic.Resistor DCR2(R = 1) annotation(Placement(transformation(extent = {{-82, 58}, {-62, 78}})));
  Electrical.Inverter_Pcontrol_ConstantEfficiency INV2(eta = 0.9) annotation(Placement(transformation(extent = {{-40, 36}, {0, 76}})));
  BaseComponents.Electrical.Phasors.Vgen_Sine_Fixed Network annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = -90, origin = {124, 54})));
  Modelica.Blocks.Sources.RealExpression iP(y = 100 + 20 * sin(2 * time) * exp(-time / 4)) annotation(Placement(transformation(extent = {{-134, -122}, {-114, -102}})));
  Modelica.Electrical.Analog.Basic.Resistor DCR3(R = 1) annotation(Placement(transformation(extent = {{-82, 14}, {-62, 34}})));
  Electrical.Inverter_Pcontrol_ConstantEfficiency INV3(eta = 0.9) annotation(Placement(transformation(extent = {{-42, -8}, {-2, 32}})));
  BaseComponents.Electrical.Phasors.Load_VPcosphi_nom ACload3 annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 270, origin = {32, 12})));
  Modelica.Electrical.Analog.Basic.Resistor DCR4(R = 1) annotation(Placement(transformation(extent = {{-82, -34}, {-62, -14}})));
  Electrical.Inverter_Pcontrol_ConstantEfficiency INV4(eta = 0.9) annotation(Placement(transformation(extent = {{-42, -56}, {-2, -16}})));
  BaseComponents.Electrical.Phasors.Load_VPcosphi_nom ACload4 annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 270, origin = {30, -36})));
  BaseComponents.Electrical.Phasors.TransmissionLine transmissionLine(l = 10) annotation(Placement(transformation(extent = {{58, -46}, {78, -26}})));
equation
  connect(DCgnd.p, VDC.n) annotation(Line(points = {{-90, -94}, {-90, -84}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(VDC.p, DCR1.p) annotation(Line(points = {{-90, -64}, {-90, 110}, {-82, 110}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(DCR1.n, INV1.DCp) annotation(Line(points = {{-62, 110}, {-38, 110}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(INV1.ACp, ACload1.p) annotation(Line(points = {{-2, 110}, {30, 110}, {30, 107}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(INV1.ACn, ACload1.n) annotation(Line(points = {{-2, 86}, {30, 86}, {30, 89}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(ACgnd.p, ACload1.n) annotation(Line(points = {{10, -96}, {10, 86}, {30, 86}, {30, 89}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(DCR2.p, DCR1.p) annotation(Line(points = {{-82, 68}, {-90, 68}, {-90, 110}, {-82, 110}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(DCR2.n, INV2.DCp) annotation(Line(points = {{-62, 68}, {-38, 68}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(INV2.ACp, Network.p) annotation(Line(points = {{-2, 68}, {124, 68}, {124, 62}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(INV2.ACn, ACload1.n) annotation(Line(points = {{-2, 44}, {10, 44}, {10, 86}, {30, 86}, {30, 89}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(DCR3.p, DCR1.p) annotation(Line(points = {{-82, 24}, {-90, 24}, {-90, 110}, {-82, 110}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(iP.y, INV2.Pac) annotation(Line(points = {{-113, -112}, {-46, -112}, {-46, 32}, {-20, 32}, {-20, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
  connect(DCR3.n, INV3.DCp) annotation(Line(points = {{-62, 24}, {-40, 24}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(INV3.Pac, INV2.Pac) annotation(Line(points = {{-22, -4}, {-22, -12}, {-46, -12}, {-46, 32}, {-20, 32}, {-20, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
  connect(INV3.ACn, ACload1.n) annotation(Line(points = {{-4, 0}, {10, 0}, {10, 86}, {30, 86}, {30, 89}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(INV3.ACp, ACload3.p) annotation(Line(points = {{-4, 24}, {32, 24}, {32, 21}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(ACload3.n, ACload1.n) annotation(Line(points = {{32, 3}, {32, 0}, {10, 0}, {10, 86}, {30, 86}, {30, 89}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(INV1.DCn, VDC.n) annotation(Line(points = {{-38, 86}, {-56, 86}, {-56, -88}, {-90, -88}, {-90, -84}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(INV2.DCn, VDC.n) annotation(Line(points = {{-38, 44}, {-56, 44}, {-56, -88}, {-90, -88}, {-90, -84}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(INV3.DCn, VDC.n) annotation(Line(points = {{-40, 1.11022e-15}, {-48, 1.11022e-15}, {-48, 0}, {-56, 0}, {-56, -88}, {-90, -88}, {-90, -84}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(DCR4.p, DCR1.p) annotation(Line(points = {{-82, -24}, {-90, -24}, {-90, 110}, {-82, 110}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(INV4.DCp, DCR4.n) annotation(Line(points = {{-40, -24}, {-62, -24}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(INV4.DCn, VDC.n) annotation(Line(points = {{-40, -48}, {-56, -48}, {-56, -88}, {-90, -88}, {-90, -84}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(INV4.Pac, INV2.Pac) annotation(Line(points = {{-22, -52}, {-22, -62}, {-46, -62}, {-46, 32}, {-20, 32}, {-20, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
  connect(INV4.ACn, ACload1.n) annotation(Line(points = {{-4, -48}, {10, -48}, {10, 86}, {30, 86}, {30, 89}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(ACload4.n, ACload1.n) annotation(Line(points = {{30, -45}, {30, -48}, {10, -48}, {10, 86}, {30, 86}, {30, 89}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(INV4.ACp, ACload4.p) annotation(Line(points = {{-4, -24}, {30, -24}, {30, -27}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(Network.n, ACload1.n) annotation(Line(points = {{124, 46}, {124, -82}, {10, -82}, {10, 86}, {30, 86}, {30, 89}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(transmissionLine.p2, Network.p) annotation(Line(points = {{77, -30}, {88, -30}, {88, 68}, {124, 68}, {124, 62}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(transmissionLine.n2, ACload1.n) annotation(Line(points = {{77, -42}, {124, -42}, {124, -82}, {10, -82}, {10, 86}, {30, 86}, {30, 89}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(transmissionLine.p1, ACload4.p) annotation(Line(points = {{59, -30}, {58, -30}, {58, -27}, {30, -27}}, color = {0, 0, 255}, smooth = Smooth.None));
  connect(ACload4.n, transmissionLine.n1) annotation(Line(points = {{30, -45}, {46, -45}, {46, -42}, {59, -42}}, color = {0, 0, 255}, smooth = Smooth.None));
  annotation(Diagram(coordinateSystem(preserveAspectRatio = false, extent = {{-140, -120}, {140, 120}}), graphics), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-140, -120}, {140, 120}})), experiment(StopTime = 20), __Dymola_experimentSetupOutput);
end Test_Inverter_Phi0andPcontrol_ConstantEfficiency;

